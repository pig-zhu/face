import{d as f,I as b,Z as v,a5 as w,a6 as I,J as C,a7 as y,a8 as j,r,v as U,x as s,f as l,w as a,F as $,o as S,a1 as L,Q as E,U as k,V as i}from"./vendor.788096f7.js";import{_ as R}from"./index.2b50ce85.js";const F=f({name:"bbt-face-similarity",data(){return{showModal:!0,showLoading:!1,minConfidence:.5,scoreThreshold:.5,inputSize:512,imgUrl1:"",imgUrl2:"",fileList1:[],fileList2:[],selectvalue1:"bbt1.jpg",selectvalue2:"bbt1.jpg",facevalue:"ssdMobilenetv1",drawImg1:"/images/bbt1.jpg",drawImg2:"/images/bbt1.jpg",defaultImgs:[{label:"bbt1.jpg",value:"bbt1.jpg"},{label:"bbt2.jpg",value:"bbt2.jpg"},{label:"bbt3.jpg",value:"bbt3.jpg"},{label:"bbt4.jpg",value:"bbt4.jpg"},{label:"bbt5.jpg",value:"bbt5.jpg"}],inputImgEl1:null,inputImgEl2:null,descriptors:{desc1:null,desc2:null},result:"-"}},watch:{selectvalue1(e){this.drawImg1=`/images/${e}`,setTimeout(()=>{this.onSelectionChanged(1)},0)},selectvalue2(e){this.drawImg2=`/images/${e}`,setTimeout(()=>{this.onSelectionChanged(2)},0)},facevalue(e){this.fnInit()}},created(){},async mounted(){this.$message=b(),this.inputImgEl1=document.getElementById("inputImg1"),this.inputImgEl2=document.getElementById("inputImg2"),this.showLoading=!0,await v("/models"),this.showLoading=!1,this.onSelectionChanged(1),this.onSelectionChanged(2)},methods:{handleChange1({event:e,file:t,fileList:d}){this.drawImg1=URL.createObjectURL(t.file),this.onSelectionChanged(1),this.fileList1=d},handleChange2({event:e,file:t,fileList:d}){this.drawImg2=URL.createObjectURL(t.file),this.onSelectionChanged(2),this.fileList2=d},async clickConfirm(e=1){if(this[`imgUrl${e}`]){let t=await this.requestExternalImage(this[`imgUrl${e}`]);this[`drawImg${e}`]=t.src,e==1?this.onSelectionChanged(1):this.onSelectionChanged(2)}},async onSelectionChanged(e){const t=await w(this[`drawImg${e}`]);this[`inputImgEl${e}`].src=t.src,this.descriptors[`desc${e}`]=await I(t),this.descriptors.desc1&&this.descriptors.desc2&&this.updateResults()},async requestExternalImage(e){let t=await fetch(e);try{let d=await t.blob();return await C(d)}catch{throw new Error("failed to load image from url: "+e)}},async updateResults(){let e=y(j(this.descriptors.desc1,this.descriptors.desc2));this.result=e>.6?`\u4E0D\u5339\u914D(${e})`:`\u76F8\u4F3C\u5EA6(${(1-e)*100}%)`}}}),o=e=>(E("data-v-6c154947"),e=e(),k(),e),B={style:{position:"relative"},class:"margin"},T={style:{width:"300px","margin-right":"10px"}},M=o(()=>s("h4",null,"\u539F\u59CB\u56FE\u7247\u8F93\u5165",-1)),V=o(()=>s("label",{for:""},"\u9009\u62E9\u4E00\u4E2A\u7167\u7247\u5427\uFF1A",-1)),D=i("\u6216\u8005"),N=o(()=>s("label",{for:""},"\u8F93\u5165\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\uFF1A",-1)),q=i("\u786E\u5B9A"),O=i("\u6216\u8005"),x=o(()=>s("label",{for:""},"\u4ECE\u672C\u5730\u9009\u4E00\u5F20\u56FE\u7247\uFF1A",-1)),z=i("\u9009\u62E9\u6587\u4EF6"),J={style:{width:"300px","margin-right":"10px"}},Q=o(()=>s("h4",null,"\u5BF9\u6BD4\u56FE\u7247\u8F93\u5165",-1)),Z=o(()=>s("label",{for:""},"\u9009\u62E9\u4E00\u4E2A\u7167\u7247\u5427\uFF1A",-1)),A=i("\u6216\u8005"),G=o(()=>s("label",{for:""},"\u8F93\u5165\u4E00\u4E2A\u56FE\u7247\u94FE\u63A5\uFF1A",-1)),H=i("\u786E\u5B9A"),K=i("\u6216\u8005"),P=o(()=>s("label",{for:""},"\u4ECE\u672C\u5730\u9009\u4E00\u5F20\u56FE\u7247\uFF1A",-1)),W=i("\u9009\u62E9\u6587\u4EF6"),X={style:{display:"flex"}},Y={style:{position:"relative","margin-right":"20px"}},ee=o(()=>s("h4",null,"\u539F\u59CB\u56FE\u7247",-1)),te=["src"],se={style:{position:"relative"}},le=o(()=>s("h4",null,"\u5BF9\u6BD4\u56FE\u7247",-1)),ae=["src"],ne=o(()=>s("div",{class:"loader"},"\u52A0\u8F7D\u4E2D...",-1));function oe(e,t,d,ie,de,re){const h=r("n-select"),u=r("n-divider"),p=r("n-input"),c=r("n-button"),g=r("n-upload"),m=r("n-space"),_=r("n-modal");return S(),U($,null,[s("div",B,[l(m,null,{default:a(()=>[s("div",T,[M,V,l(h,{value:e.selectvalue1,"onUpdate:value":t[0]||(t[0]=n=>e.selectvalue1=n),options:e.defaultImgs},null,8,["value","options"]),l(u,{"title-placement":"left"},{default:a(()=>[D]),_:1}),N,l(p,{value:e.imgUrl1,"onUpdate:value":t[1]||(t[1]=n=>e.imgUrl1=n),type:"text",placeholder:"\u56FE\u7247\u94FE\u63A5"},null,8,["value"]),l(c,{onClick:t[2]||(t[2]=n=>e.clickConfirm(1))},{default:a(()=>[q]),_:1}),l(u,{"title-placement":"left"},{default:a(()=>[O]),_:1}),x,l(g,{onChange:e.handleChange1,"default-upload":!1,ref:"upload1"},{default:a(()=>[l(c,null,{default:a(()=>[z]),_:1})]),_:1},8,["onChange"])]),s("div",J,[Q,Z,l(h,{value:e.selectvalue2,"onUpdate:value":t[3]||(t[3]=n=>e.selectvalue2=n),options:e.defaultImgs},null,8,["value","options"]),l(u,{"title-placement":"left"},{default:a(()=>[A]),_:1}),G,l(p,{value:e.imgUrl2,"onUpdate:value":t[4]||(t[4]=n=>e.imgUrl2=n),type:"text",placeholder:"\u56FE\u7247\u94FE\u63A5"},null,8,["value"]),l(c,{onClick:t[5]||(t[5]=n=>e.clickConfirm(2))},{default:a(()=>[H]),_:1}),l(u,{"title-placement":"left"},{default:a(()=>[K]),_:1}),P,l(g,{onChange:e.handleChange2,"default-upload":!1,ref:"upload2"},{default:a(()=>[l(c,null,{default:a(()=>[W]),_:1})]),_:1},8,["onChange"]),l(u,{"title-placement":"left"}),s("h4",null,"\u5339\u914D\u7ED3\u679C\uFF1A"+L(e.result),1)]),s("div",X,[s("div",Y,[ee,s("img",{id:"inputImg1",style:{"max-width":"100%",border:"0"},src:e.drawImg1},null,8,te)]),s("div",se,[le,s("img",{id:"inputImg2",style:{"max-width":"100%",border:"0"},src:e.drawImg2},null,8,ae)])])]),_:1})]),l(_,{show:e.showLoading,"onUpdate:show":t[6]||(t[6]=n=>e.showLoading=n),"mask-closable":!1},{default:a(()=>[ne]),_:1},8,["show"])],64)}var he=R(F,[["render",oe],["__scopeId","data-v-6c154947"]]);export{he as default};
